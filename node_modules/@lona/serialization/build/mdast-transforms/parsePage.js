"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const unist_util_visit_1 = __importDefault(require("unist-util-visit"));
const unified_1 = __importDefault(require("unified"));
const rehype_parse_1 = __importDefault(require("rehype-parse"));
const htmlParser = unified_1.default().use(rehype_parse_1.default, { fragment: true });
function parsePage() {
    return (ast) => {
        unist_util_visit_1.default(ast, 'jsx', (node) => {
            const { type, tagName, properties: { className, href }, children = [], } = htmlParser.parse(node.value).children[0];
            if (type === 'element' &&
                tagName === 'a' &&
                Array.isArray(className) &&
                className.includes('page')) {
                // @ts-ignore
                node.type = 'page';
                node.url = href;
                node.value = (children[0] && children[0].value) || href;
            }
            return node;
        });
        return ast;
    };
}
exports.default = parsePage;
